<header class="header" [class.sidebar-collapsed]="sidebarCollapsed()">
    <!-- Left: Breadcrumbs -->
    <div class="header-left">
        <nav class="breadcrumbs" aria-label="Breadcrumb">
            @for (crumb of breadcrumbs(); track crumb.route; let last = $last) {
            @if (!last) {
            <a [routerLink]="crumb.route" class="breadcrumb-link">{{ crumb.label }}</a>
            <span class="breadcrumb-separator">/</span>
            } @else {
            <span class="breadcrumb-current">{{ crumb.label }}</span>
            }
            }
        </nav>
    </div>

    <!-- Center: Search -->
    <div class="header-center">
        <div class="search-container">
            <lucide-icon [img]="icons.search" [size]="18" class="search-icon"></lucide-icon>
            <input type="text" class="search-input" placeholder="Search cases, applicants, or A-numbers..."
                [value]="searchQuery()" (input)="onSearch($event)">
            <span class="search-shortcut">âŒ˜K</span>
        </div>
    </div>

    <!-- Right: Actions -->
    <div class="header-right">
        <!-- Security indicator -->
        <div class="security-indicator">
            <lucide-icon [img]="icons.lock" [size]="14"></lucide-icon>
            <span>Secure</span>
        </div>

        <!-- Help -->
        <button class="header-btn" title="Help & Documentation">
            <lucide-icon [img]="icons.help" [size]="20"></lucide-icon>
        </button>

        <!-- Notifications -->
        <div class="notification-wrapper">
            <button class="header-btn notification-btn" (click)="toggleNotifications()"
                [class.active]="showNotifications()" title="Notifications">
                <lucide-icon [img]="icons.bell" [size]="20"></lucide-icon>
                @if (notificationCount() > 0) {
                <span class="notification-badge">{{ notificationCount() }}</span>
                }
            </button>

            @if (showNotifications()) {
            <div class="dropdown notification-dropdown">
                <div class="dropdown-header">
                    <span class="dropdown-title">Notifications</span>
                    <button class="mark-read-btn">Mark all read</button>
                </div>
                <div class="notification-list">
                    @for (notification of notifications; track notification.id) {
                    <div class="notification-item" [class]="'notification-' + notification.type">
                        <div class="notification-content">
                            <p class="notification-message">{{ notification.message }}</p>
                            <span class="notification-time">{{ notification.time }}</span>
                        </div>
                    </div>
                    }
                </div>
                <div class="dropdown-footer">
                    <a routerLink="/notifications" class="view-all-link">View all notifications</a>
                </div>
            </div>
            }
        </div>

        <!-- User Menu -->
        <div class="user-wrapper">
            <button class="user-menu-btn" (click)="toggleUserMenu()" [class.active]="showUserMenu()">
                <div class="user-avatar-small">
                    @if (user.avatar) {
                    <img [src]="user.avatar" [alt]="user.name">
                    } @else {
                    <lucide-icon [img]="icons.user" [size]="16"></lucide-icon>
                    }
                </div>
                <span class="user-name-short">{{ user.name.split(' ')[0] }}</span>
                <lucide-icon [img]="icons.chevronDown" [size]="14" class="chevron"></lucide-icon>
            </button>

            @if (showUserMenu()) {
            <div class="dropdown user-dropdown">
                <div class="user-info-header">
                    <div class="user-avatar-large">
                        <lucide-icon [img]="icons.user" [size]="24"></lucide-icon>
                    </div>
                    <div class="user-details">
                        <span class="user-name">{{ user.name }}</span>
                        <span class="user-email">{{ user.email }}</span>
                        <span class="user-role-badge">{{ user.role }}</span>
                    </div>
                </div>
                <div class="dropdown-divider"></div>
                <ul class="dropdown-menu">
                    <li><a routerLink="/settings/profile">Profile Settings</a></li>
                    <li><a routerLink="/settings/security">Security</a></li>
                    <li><a routerLink="/help">Help Center</a></li>
                </ul>
                <div class="dropdown-divider"></div>
                <button class="sign-out-btn">Sign Out</button>
            </div>
            }
        </div>
    </div>
</header>